!function(a){{var b="facebook_access_token",c="1441065776156228",d="https://www.facebook.com/connect/login_success.html",e=!1,f="[NewsFeedManager]",g={"*":!1,FBtest:!0},h=function(){var a=Array.prototype.slice.call(arguments,0);a.splice(0,0,f),e&&console&&console.log&&console.log.apply(console,a)},i=function(){var a=null;try{a=localStorage[b]?JSON.parse(localStorage[b]):null}catch(c){h("Could not parse token",c),a=null}return a&&"object"==typeof a&&"token"in a?a.token:null},j=function(a){localStorage[b]=JSON.stringify({token:a})},k=function(a,b,c){var d=new XMLHttpRequest,e="https://graph.facebook.com/v2.1/"+a.what+"?access_token="+a.accessToken+"&fields="+a.fields;h("Sending Facebook Request",a),d.onreadystatechange=function(){var a=d.readyState,e=d.status;if(4==a)if(200==e){var f=JSON.parse(d.responseText);h("Facebook Call Successful",f),feeds=f.data,"function"==typeof b&&b(feeds)}else h("Facebook Call Failed",f),"function"==typeof c&&c()},d.open("GET",e,!0),d.send()},l=function(a){var b=i();b||chrome.windows.getAll({},function(b){for(var c=0;c<b.length;c++){var e=b[c].id;chrome.tabs.query({active:!0,windowId:e},function(b){if(0==b[0].url.indexOf(d)){var c=document.createElement("a");c.href=b[0].url;var f=c.href.split("#")[1];f=f.split("&");for(var g=null,i=0;i<f.length;i++)if(0==f[i].indexOf("access_token")){g=f[i].split("=")[1],j(g),h("Received login token");break}chrome.windows.remove(e),h("Closed success window"),a(g)}})}})},m=function(a){j(null),h("Displaying facebook login window");var b=function(){l(function(){"function"==typeof a&&a(i()),chrome.tabs.onUpdated.removeListener(b)})};chrome.tabs.onUpdated.addListener(b);var e="https://www.facebook.com/dialog/oauth?client_id="+c+"&response_type=token&scope=read_stream&auth_type=rerequest&redirect_uri="+d;window.open(e,"SignIn","width=1000,height=630,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0")};a.NewsFeedManager={isEnabled:function(){var a=localStorage.LAST_APP_NAME;return 1==g["*"]?!0:a&&a in g&&g[a]===!0?!0:!1},checkToken:function(){return null!=i()},login:function(a){m(function(){"function"==typeof a&&a()})},logout:function(){j(null)},getFeed:function(a,b){var c=i(),d={what:"me/home",fields:"actions,story,link,type,message,created_time,picture,from{name,picture{url}}",accessToken:c};k(d,a,b)},destroyFacebook:function(){},log:function(){h.apply(h,arguments)}}}}(this);