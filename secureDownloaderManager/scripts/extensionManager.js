!function(a){var b="ENABLED_EXTENSION_IDS",c="ENABLED_APP",d="ENABLED_THEME_UID",e="ENABLED_THEME_APP",f={};chrome.management.onInstalled.addListener(function(a){"theme"===a.type&&(f[a.name]=a.id,chrome.management.setEnabled(a.id,!0),localStorage[e]=JSON.stringify(a))});var g=a.extensionManager={ensureExtension:function(a,b){console.log("ensureExt : "+a),chrome.management.get(a,function(c){chrome.runtime.lastError||!c||"0.0"===c.version?(chrome.management.onInstalled.addListener(function d(c){c.id===a&&(chrome.management.onInstalled.removeListener(d),b(c))}),chrome.sienium.installApp(a,{},function(a){(chrome.runtime.lastError||!a)&&console.log("ext install error")})):(c.enabled||chrome.management.setEnabled(a,!0),b(c))})},toggleExtensions:function(a){var b=localStorage[c],d=a.Components||[],e=d.map(function(a){return 2!==a.Type&&3!==a.Type||!a.Data.key?null:a.Data.key}).filter(function(a){return null!==a});b&&a.Name==b||(localStorage[c]=a.Name,g.disableExtensions(),g.enableExtensions(e))},enableExtensions:function(a){a&&a.length&&(a.forEach(function(a){chrome.management.get(a,function(a){chrome.runtime.lastError||!a?chrome.sienium.installApp(extensionId,{},function(a){console.log(a)}):a.enabled||chrome.management.setEnabled(a.id,!0)})}),localStorage[b]=JSON.stringify(a))},disableExtensions:function(){var a=localStorage[b];if(a&&a.length){var c=JSON.parse(a);c&&c.forEach(function(a){chrome.management.get(a,function(a){a&&a.enabled&&chrome.management.setEnabled(a.id,!1)})})}localStorage.removeItem(b)},toggleTheme:function(a,b){var c;if(b)try{c=JSON.parse(localStorage[e])}catch(g){}a.Data.themeUid?localStorage[d]!==a.Data.themeUid?(f[a.Name]?this.enableTheme(f[a.Name]):this.downloadTheme(a.Data.themeUid),b&&c&&this.uninstallTheme(c.id)):b&&this.downloadTheme(a.Data.themeUid):this.disableTheme(),localStorage[d]=a.Data.themeUid},downloadTheme:function(a){var b="http://public.visibay.com/raw/"+a;chrome.sienium.installApp(a,{install_url:b},function(a){console.log(a)})},enableTheme:function(a){chrome.management.setEnabled(a,!0)},disableTheme:function(){chrome.management.getAll(function(a){a.forEach(function(a){"theme"===a.type&&chrome.management.setEnabled(id,!1)})})},uninstallTheme:function(a){chrome.management.uninstall(a)}}}(window);