!function(a){function b(a,b){return void 0===a?localStorage.LAST_APP_NAME:(localStorage.LAST_APP_NAME=a,void(localStorage.LAST_APP_UID=b))}function c(a,b){var c=new XMLHttpRequest;c.open("GET","http://public.visibay.com/api/app/?name="+encodeURIComponent(a)+"&fillComponents=true",!0),c.responseType="json",c.setRequestHeader("Accept","application/json"),c.onload=function(){if(200===this.status){var a=this.response;return"string"==typeof a&&(a=JSON.parse(a)),b(a)}b(null)},c.onerror=function(){b(null)},c.send()}function d(a){chrome.sienium.getConfigFile("appiance.json",function(b){b=JSON.parse(b);var c={appInstanceUid:b.appinstanceuid,appNames:b.Appiance.map(function(a){return a.name})};a(c)})}var e=a.appManager={onAppChanged:new chrome.Event,current:null,appInstanceUid:null,isAppReady:!1,isBgReady:{appName:null,isReady:!1,externally:!1,secureDownloader:null,yappyz:null},online:!0,isFirstLaunch:!0,changeIsReady:function(){e.isBgReady.isReady&&e.isAppReady?(e.isBgReady.isReady=!1,e.isAppReady=!1,e.change(e.isBgReady.appName,e.isBgReady.externally)):e.isBgReady.isReady||(e.isAppReady=!1,e.change())},change:function(a,f){e.isFirstRun=null===e.current,e.isBgReady.appName=null,e.isBgReady.externally=!1,d(function(d){if(a||(a=b()),a||(a=d.appNames[d.appNames.length-1]),e.appInstanceUid=d.appinstanceuid,e.current&&e.current.Name==a&&e.online){var g=null===e.current;d.currentApp=e.current,e.onAppChanged.dispatch({online:!0,config:d,firstLaunch:g,externally:f})}else c(a,function(a){if(a){if(tracking.postEvent("BrowserLaunch",{user:appInstanceUid},a.AppUid),e.online=!0,d.currentApp=a,a.Data.settings)var c=JSON.parse(a.Data.settings);navigator.appVersion.indexOf("Windows")>0&&chrome.sienium.isFirstRun(function(a){if(a&&"undefined"!=typeof c.desktopshortcut)for(shortcut in c.desktopshortcut)chrome.sienium.createShortcut(c.desktopshortcut[shortcut].name,c.desktopshortcut[shortcut].url,1,c.desktopshortcut[shortcut].logo,function(a){return chrome.runtime.lastError?void console.log(a):void 0})}),b(a.Name,a.AppUid);var g=null===e.current;e.current=a,e.onAppChanged.dispatch({online:!0,config:d,firstLaunch:g,externally:f})}else e.online=!1,e.onAppChanged.dispatch({online:!1})})})},load:function(){chrome.sienium.getLaunchCommandLine&&chrome.sienium.onCommandLineInvoked?chrome.sienium.getLaunchCommandLine(function(a){namespace="";for(var b=0;b<a.length;b++)"namespace"==a[b].name?namespace=a[b].value:"url"==a[b].name&&(a[b].value.indexOf("http://")>0?e.isBgReady.secureDownloader=a[b].value:e.isBgReady.yappyz=a[b].value);e.isBgReady.appName=namespace,e.isBgReady.externally=!1,e.isBgReady.isReady=!0}):chrome.sienium.getNamespace&&chrome.sienium.onNamespaceInvoked&&chrome.sienium.getNamespace(function(a){e.isBgReady.appName=a,e.isBgReady.externally=!1,e.isBgReady.isReady=!0,chrome.sienium.onNamespaceInvoked.addListener(function(a){e.isBgReady.appName=a,e.isBgReady.externally=!1,e.isBgReady.isReady=!0})})}}}(this);