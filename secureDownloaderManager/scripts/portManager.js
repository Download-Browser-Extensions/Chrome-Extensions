!function(a){var b=function(){this.init()};b.prototype={ports:null,onMessage:null,onConnect:null,init:function(){this.ports=[],this.onMessage=new chrome.Event,this.onConnect=new chrome.Event},length:function(){return this.ports.length},hasPorts:function(){return this.length()>0},postMessage:function(a,b){this.ports.forEach(function(c){b&&b!==c.sender.tab.windowId||c.postMessage(a)})},addPort:function(a){var b=this;this.ports.push(a),a.onDisconnect.addListener(function(){var c=b.ports.indexOf(a);c>=0&&b.ports.splice(c,1)}),a.onMessage.addListener(function(c){b.onMessage.dispatch(c,a)}),b.onConnect.dispatch(a)}},b.list={};a.portManager={launchAndConnect:function(a,b){function c(a){d(a)&&chrome.management.onInstalled.removeListener(c)}function d(c){return c&&"0.0"!==c.version&&c.id===a?(chrome.management.launchApp(a,function(){var c=chrome.runtime.connect(a);b(c)}),!0):!1}chrome.management.get(a,function(b){return console.log(a),chrome.runtime.lastError?void console.log("port error"):void(d(b)||(chrome.management.onInstalled.addListener(c),chrome.sienium.installApp(a,{},function(a){console.log(a)})))})},pool:function(a){var c=b.list[a];return c||(b.list[a]=c=new b(a)),c}};!function(){chrome.runtime.onConnect.addListener(function(a){var c=b.list[a.name];c&&c.addPort(a)})}()}(window);